var Event=function(){"use strict";this.attach=function(e,t,o,n){var a="",l=void 0===n||n,r=null;return void 0===window.addEventListener?(a="on"+e,r=function(e,o){return t.attachEvent(e,o),o}):(a=e,r=function(e,o,n){return t.addEventListener(e,o,n),o}),r.apply(t,[a,function(e){var t=e||event,n=t.srcElement||t.target;o(t,n)},l])},this.detach=function(e,t,o,n){var a="",l=void 0===n||n;void 0===window.removeEventListener?(a="on"+e,t.detachEvent(a,o)):(a=e,t.removeEventListener(a,o,l))},this.stop=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},this.prevent=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}},Magnifier=function(e,t){"use strict";var o=t||{},n=null,a={x:0,y:0,w:0,h:0,lensW:0,lensH:0,lensBgX:0,lensBgY:0,largeW:0,largeH:0,largeL:0,largeT:0,zoom:2,zoomMin:1.1,zoomMax:5,mode:"outside",largeWrapperId:void 0!==o.largeWrapper&&o.largeWrapper.id||null,status:0,zoomAttached:!1,zoomable:void 0!==o.zoomable&&o.zoomable,onthumbenter:void 0!==o.onthumbenter?o.onthumbenter:null,onthumbmove:void 0!==o.onthumbmove?o.onthumbmove:null,onthumbleave:void 0!==o.onthumbleave?o.onthumbleave:null,onzoom:void 0!==o.onzoom?o.onzoom:null},l={t:0,l:0,x:0,y:0},r=0,s=0,i="",m=null,u=null,d=void 0!==o.zoom?o.zoom:a.zoom,h=void 0!==o.zoomMin?o.zoomMin:a.zoomMin,g=void 0!==o.zoomMax?o.zoomMax:a.zoomMax,c=o.mode||a.mode,p={},v=!1,b=0,f=function(e){var t="",o=e.charAt(0),n=null;if("#"!==o&&"."!==o||(t=e.substr(1,e.length)),""!==t)switch(o){case"#":n=document.getElementById(t);break;case".":n=function(e){var t=[],o=null,n=0,a="",l=0,r=0;if(document.getElementsByClassName)t=document.getElementsByClassName(e);else for(n=(o=document.getElementsByTagName("*")).length,a=new RegExp("(^|\\s)"+e+"(\\s|$)");l<n;l+=1)a.test(o[l].className)&&(t[r]=o[l],r+=1);return t}(t)}return n},z=function(e,t,o,n){var a=f("#"+e+"-lens"),l=null;1===p[e].status?((l=document.createElement("div")).className="magnifier-loader-text",a.className="magnifier-loader hidden",l.appendChild(document.createTextNode("Loading...")),a.appendChild(l)):2===p[e].status&&(a.className="magnifier-lens hidden",a.removeChild(a.childNodes[0]),a.style.background="url("+t.src+") no-repeat 0 0 scroll",o.id=e+"-large",o.style.width=p[e].largeW+"px",o.style.height=p[e].largeH+"px",o.className="magnifier-large hidden","inside"===p[e].mode?a.appendChild(o):n.appendChild(o)),a.style.width=p[e].lensW+"px",a.style.height=p[e].lensH+"px"},x=function(){var e=l.x-a.x,t=l.y-a.y,o=0,n=0;v=!(e<0||t<0||e>a.w||t>a.h),n=e-a.lensW/2,o=t-a.lensH/2,"inside"!==a.mode&&(e<a.lensW/2&&(n=0),t<a.lensH/2&&(o=0),e-a.w+a.lensW/2>0&&(n=a.w-(a.lensW+2)),t-a.h+a.lensH/2>0&&(o=a.h-(a.lensH+2))),l.l=Math.round(n),l.t=Math.round(o),a.lensBgX=l.l+1,a.lensBgY=l.t+1,"inside"===a.mode?(a.largeL=Math.round(e*(a.zoom-a.lensW/a.w)),a.largeT=Math.round(t*(a.zoom-a.lensH/a.h))):(a.largeL=Math.round(a.lensBgX*a.zoom*(a.largeWrapperW/a.w)),a.largeT=Math.round(a.lensBgY*a.zoom*(a.largeWrapperH/a.h)))},y=function(e){var t=e.wheelDelta>0||e.detail<0?.1:-.1,o=a.onzoom,r=1,s=0,i=0;e.preventDefault&&e.preventDefault(),e.returnValue=!1,a.zoom=Math.round(10*(a.zoom+t))/10,a.zoom>=a.zoomMax?a.zoom=a.zoomMax:a.zoom>=a.zoomMin?(a.lensW=Math.round(a.w/a.zoom),a.lensH=Math.round(a.h/a.zoom),"inside"===a.mode?(s=a.w,i=a.h):(s=a.largeWrapperW,i=a.largeWrapperH,r=a.largeWrapperW/a.w),a.largeW=Math.round(a.zoom*s),a.largeH=Math.round(a.zoom*i),x(),m.style.left=l.l+"px",m.style.top=l.t+"px",m.style.width=a.lensW+"px",m.style.height=a.lensH+"px",m.style.backgroundPosition="-"+a.lensBgX+"px -"+a.lensBgY+"px",u.style.left="-"+a.largeL+"px",u.style.top="-"+a.largeT+"px",u.style.width=a.largeW+"px",u.style.height=a.largeH+"px",null!==o&&o({thumb:n,lens:m,large:u,x:l.x,y:l.y,zoom:Math.round(a.zoom*r*10)/10,w:a.lensW,h:a.lensH})):a.zoom=a.zoomMin},M=function(){a=p[i],m=f("#"+i+"-lens"),2===a.status?(m.className="magnifier-lens",!1===a.zoomAttached&&(void 0!==a.zoomable&&!0===a.zoomable&&(e.attach("mousewheel",m,y),window.addEventListener&&m.addEventListener("DOMMouseScroll",function(e){y(e)})),a.zoomAttached=!0),(u=f("#"+i+"-large")).className="magnifier-large"):1===a.status&&(m.className="magnifier-loader")},W=function(){if(a.status>0){var e=a.onthumbleave;null!==e&&e({thumb:n,lens:m,large:u,x:l.x,y:l.y}),-1===m.className.indexOf("hidden")&&(m.className+=" hidden",n.className=a.thumbCssClass,null!==u&&(u.className+=" hidden"))}},w=function(){if(s!==a.status&&M(),a.status>0){n.className=a.thumbCssClass+" opaque",1===a.status?m.className="magnifier-loader":2===a.status&&(m.className="magnifier-lens",u.className="magnifier-large",u.style.left="-"+a.largeL+"px",u.style.top="-"+a.largeT+"px"),m.style.left=l.l+"px",m.style.top=l.t+"px",m.style.backgroundPosition="-"+a.lensBgX+"px -"+a.lensBgY+"px";var e=a.onthumbmove;null!==e&&e({thumb:n,lens:m,large:u,x:l.x,y:l.y})}s=a.status},N=function(e,t){var o=e.getBoundingClientRect(),n=0,a=0;t.x=o.left,t.y=o.top,t.w=Math.round(o.right-t.x),t.h=Math.round(o.bottom-t.y),t.lensW=Math.round(t.w/t.zoom),t.lensH=Math.round(t.h/t.zoom),"inside"===t.mode?(n=t.w,a=t.h):(n=t.largeWrapperW,a=t.largeWrapperH),t.largeW=Math.round(t.zoom*n),t.largeH=Math.round(t.zoom*a)};this.attach=function(e){if(void 0===e.thumb)throw{name:"Magnifier error",message:"Please set thumbnail",toString:function(){return this.name+": "+this.message}};var t=f(e.thumb),o=0;if(void 0!==t.length)for(;o<t.length;o+=1)e.thumb=t[o],this.set(e);else e.thumb=t,this.set(e)},this.setThumb=function(e){n=e},this.set=function(t){if(void 0!==p[t.thumb.id])return n=t.thumb,!1;var o=new Image,s=new Image,v=t.thumb,y=v.id,H=null,E=null,B=f("#"+t.largeWrapper)||f("#"+v.getAttribute("data-large-img-wrapper"))||f("#"+a.largeWrapperId),C=t.zoom||v.getAttribute("data-zoom")||d,A=t.zoomMin||v.getAttribute("data-zoom-min")||h,L=t.zoomMax||v.getAttribute("data-zoom-max")||g,T=t.mode||v.getAttribute("data-mode")||c,D=void 0!==t.onthumbenter?t.onthumbenter:a.onthumbenter,X=void 0!==t.onthumbleave?t.onthumbleave:a.onthumbleave,Y=void 0!==t.onthumbmove?t.onthumbmove:a.onthumbmove,I=void 0!==t.onzoom?t.onzoom:a.onzoom;if(E=void 0===t.large?null!==t.thumb.getAttribute("data-large-img-url")?t.thumb.getAttribute("data-large-img-url"):t.thumb.src:t.large,null===B&&"inside"!==T)throw{name:"Magnifier error",message:"Please specify large image wrapper DOM element",toString:function(){return this.name+": "+this.message}};void 0!==t.zoomable?H=t.zoomable:null!==v.getAttribute("data-zoomable")?H="true"===v.getAttribute("data-zoomable"):void 0!==a.zoomable&&(H=a.zoomable),""===v.id&&(y=v.id="magnifier-item-"+r,r+=1),function(e,t){var o=document.createElement("div");o.id=t+"-lens",o.className="magnifier-loader",e.parentNode.appendChild(o)}(v,y),p[y]={zoom:C,zoomMin:A,zoomMax:L,mode:T,zoomable:H,thumbCssClass:v.className,zoomAttached:!1,status:0,largeUrl:E,largeWrapperId:"outside"===T?B.id:null,largeWrapperW:"outside"===T?B.offsetWidth:null,largeWrapperH:"outside"===T?B.offsetHeight:null,onzoom:I,onthumbenter:D,onthumbleave:X,onthumbmove:Y},e.attach("mouseover",v,function(e,t){0!==a.status&&W(),i=t.id,n=t,M(),N(n,a),l.x=e.clientX,l.y=e.clientY,x(),w();var o=a.onthumbenter;null!==o&&o({thumb:n,lens:m,large:u,x:l.x,y:l.y})},!1),e.attach("mousemove",v,function(e,t){b=1}),e.attach("load",o,function(){p[y].status=1,N(v,p[y]),z(y),e.attach("load",s,function(){p[y].status=2,z(y,v,s,B)}),s.src=p[y].largeUrl}),o.src=v.src},e.attach("mousemove",document,function(e){l.x=e.clientX,l.y=e.clientY,x(),!0===v?w():(0!==b&&W(),b=0)},!1),e.attach("scroll",window,function(){null!==n&&N(n,a)})};